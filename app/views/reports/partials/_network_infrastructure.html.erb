<div class="page-break">
  <% network = @report_data.dig(:findings, :network_infrastructure) || {} %>
  <% shared_summary = network[:shared_hosting_summary] || {} %>
  <% shared_hosts = shared_summary[:hosts] || [] %>

  <% if network[:asn_count].to_i > 0 || shared_hosts.any? %>
    <div class="report-section">
      <h3 class="heading-md text-center">Network Infrastructure</h3>
      <h4 class="heading-sm mb-3">AS Number Overview</h4>
      <div class="text-base text-blue mb-3">
        <strong>Total ASNs Identified:</strong> <%= network[:asn_count] %>
      </div>
      
      <%= render 'reports/partials/shared_hosting', shared_hosts: shared_hosts, note: shared_summary[:note] %>
    </div>
  <% end %>
</div>
